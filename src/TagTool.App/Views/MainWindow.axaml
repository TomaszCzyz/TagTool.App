<Window
    xmlns="https://github.com/avaloniaui"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:vm="using:TagTool.App.ViewModels"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:userControls="clr-namespace:TagTool.App.Views.UserControls"
    mc:Ignorable="d" d:DesignWidth="1400" d:DesignHeight="700"
    x:Class="TagTool.App.Views.MainWindow"
    x:Name="RootWindow"
    Icon="/Assets/avalonia-logo.ico"
    Title="TagTool.App"
    ExtendClientAreaChromeHints="Default"
    ExtendClientAreaToDecorationsHint="True"
    ExtendClientAreaTitleBarHeightHint="-1"
    Background="{StaticResource MyLightPrimary200}">
    <Window.KeyBindings>
        <KeyBinding Gesture="Escape" Command="{Binding ResetFocusCommand}" CommandParameter="{Binding #RootWindow}" />
        <KeyBinding Gesture="Ctrl+Q" Command="{Binding FocusNextSearchTabCommand}" CommandParameter="{Binding #RootWindow}" />
    </Window.KeyBindings>
    <Window.Styles>
        <Style Selector="Border.MenuPanel">
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="BorderBrush">
                <SolidColorBrush Color="{StaticResource MyLightPrimary800}" Opacity="0.3" />
            </Setter>
            <Setter Property="Background" Value="{StaticResource MyLightPrimary300}" />
        </Style>
        <Style Selector="RadioButton.SideMenu">
            <Setter Property="Template">
                <ControlTemplate>
                    <ToggleButton
                        DataContext="{Binding $parent}"
                        Background="Transparent"
                        Padding="3"
                        Content="{Binding Content, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}"
                        IsChecked="{Binding IsChecked, RelativeSource={RelativeSource TemplatedParent}, Mode=TwoWay}" />

                </ControlTemplate>
            </Setter>
        </Style>
    </Window.Styles>

    <Design.DataContext>
        <vm:MainWindowViewModel />
    </Design.DataContext>

    <Grid RowDefinitions="Auto,*">
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="{Binding ActiveLeftToolWidth, Mode=TwoWay}" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
            <ColumnDefinition Width="{Binding ActiveRightToolWidth, Mode=TwoWay}" />
        </Grid.ColumnDefinitions>

        <!-- Top menu -->
        <Border
            Grid.Row="0"
            Grid.ColumnSpan="7"
            Classes="MenuPanel"
            Margin="-1 -1 -1 0"
            PointerPressed="InputElement_OnPointerPressed"
            PointerReleased="InputElement_OnPointerReleased"
            PointerMoved="InputElement_OnPointerMoved">

            <userControls:MenuView />
        </Border>

        <!-- Left tool menu -->
        <Border
            Grid.Row="1"
            Grid.Column="0"
            Classes="MenuPanel"
            Margin="-1 -1  0 -1">
            
            <TabControl>
                <TabItem Header="tool1">tab1</TabItem>
                <TabItem Header="tool2">tab2</TabItem>
            </TabControl>
        </Border>

        <GridSplitter Grid.Row="1" Grid.Column="1" ResizeDirection="Columns" Width="4" />

        <!-- Main panel -->
        <userControls:MainPanel Grid.Row="1" Grid.Column="2" />

        <GridSplitter Grid.Row="1" Grid.Column="3" ResizeDirection="Columns" Width="4" />

        <!-- Right tool menu -->
        <Border
            Grid.Row="1"
            Grid.Column="4"
            Classes="MenuPanel"
            Margin="0 -1 -1 -1">

            <TabControl>
                <TabItem Header="tool1">tab1</TabItem>
                <TabItem Header="tool2">tab2</TabItem>
            </TabControl>

        </Border>
    </Grid>
</Window>
